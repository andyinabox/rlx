.TH "RLX" "1" "September 2014" "rlx 0.1.262" "User Commands"
.SH "NAME"
rlx -- Command line interface for couchdb.
.SH "SYNOPSIS"

.SP
rlx <command> [\-c] [\-\-color|\-\-no\-color] [\-c|\-\-compress]
.br
    [\-\-interactive|\-\-no\-interactive] [\-\-recursive] [\-\-force] [\-\-http]
.br
    [\-\-trace] [\-\-debug] [\-\-info] [\-\-warn] [\-\-error] [\-\-help] [\-\-version]
.br
    [\-s|\-\-server=<url>] [\-d|\-\-database=<name>] [\-i|\-\-id=<id>]
.br
    [\-a|\-\-attachment=<file>] [\-r|\-\-rev=<rev>] [\-u|\-\-username=<name>]
.br
    [\-p|\-\-password=<pass>] [\-o|\-\-output=<file>] [\-f|\-\-file=<file>]
.br
    [\-j|\-\-json=<json>] [\-t|\-\-template=<name>] [\-q|\-\-query=<params...>]
.br
    [\-h|\-\-header=<key:value...>] [\-g|\-\-glob=<pattern...>]
.br
    [\-\-destination=<url>] [\-\-ddoc=<name>] [\-n|\-\-name=<name>]
.br
    [\-\-feed=<type>] <args>
.SH "DESCRIPTION"
.PP
Designed for parity with the couchdb HTTP API, run \fBhelp <cmd>\fR for more information on individual commands, start an interactive session with \fBrlx i\fR.
.SH "COMMANDS"
.BL
.IP "\[ci]" 4
\fBadmin\fR: Manage server administrators.
.IP "\[ci]" 4
\fBuser, usr\fR: Manage server users.
.IP "\[ci]" 4
\fBdatabase, db\fR: Manage databases.
.IP "\[ci]" 4
\fBsecurity, sec\fR: Get or set database security.
.IP "\[ci]" 4
\fBdocument, doc\fR: Manage documents.
.IP "\[ci]" 4
\fBbulk\fR: Bulk document tasks.
.IP "\[ci]" 4
\fBattach, att\fR: Manage document attachments.
.IP "\[ci]" 4
\fBreplicate, repl\fR: Replicate a database.
.IP "\[ci]" 4
\fBapplication, app\fR: Manage design document applications.
.IP "\[ci]" 4
\fBlocal, lcl\fR: Manage local documents.
.IP "\[ci]" 4
\fBlogin\fR: Login to a server.
.IP "\[ci]" 4
\fBlogout\fR: Logout of current session.
.IP "\[ci]" 4
\fBsession, sess\fR: Session authentication.
.IP "\[ci]" 4
\fBconfig, conf\fR: Manage server configuration.
.IP "\[ci]" 4
\fBinfo\fR: Print server information.
.IP "\[ci]" 4
\fBstats\fR: Print server statistics.
.IP "\[ci]" 4
\fBtasks\fR: Print active tasks. 
.IP "\[ci]" 4
\fBlog\fR: Tail server log file. 
.IP "\[ci]" 4
\fBrestart\fR: Restart a server.
.IP "\[ci]" 4
\fBuuids\fR: Print list of uuids.
.IP "\[ci]" 4
\fBedit\fR: Edit a document.
.IP "\[ci]" 4
\fBtemplate, tpl\fR: Manage template files.
.IP "\[ci]" 4
\fBlint\fR: Lint javascript and json.
.IP "\[ci]" 4
\fBlevel, lvl\fR: Get or set the server log level.
.IP "\[ci]" 4
\fBwhoami\fR: Get current user information.
.IP "\[ci]" 4
\fBrunconf, rc\fR: Runtime configuration.
.IP "\[ci]" 4
\fBinteractive, i\fR: Interactive REPL console.
.IP "\[ci]" 4
\fBhelp\fR: Show help for commands.
.EL
.SH "OPTIONS"
.BL
.IP "\[ci]" 4
\fB\-g, \-\-glob=[pattern...]\fR: File match pattern(s).
.IP "\[ci]" 4
\fB\-\-[no]\-color\fR: Enable or disable terminal colors.
.IP "\[ci]" 4
\fB\-d, \-\-database=[name]\fR: Database name.
.IP "\[ci]" 4
\fB\-i, \-\-id=[id]\fR: Document identifier.
.IP "\[ci]" 4
\fB\-a, \-\-attachment=[file]\fR: Attachment file path.
.IP "\[ci]" 4
\fB\-r, \-\-rev=[rev]\fR: Document revision.
.IP "\[ci]" 4
\fB\-u, \-\-username=[name]\fR: Authentication username.
.IP "\[ci]" 4
\fB\-p, \-\-password=[pass]\fR: Authentication password.
.IP "\[ci]" 4
\fB\-o, \-\-output=[file]\fR: Write response to output file.
.IP "\[ci]" 4
\fB\-f, \-\-file=[file]\fR: Read JSON input from file.
.IP "\[ci]" 4
\fB\-j, \-\-json=[json]\fR: JSON string literal (overrides \-\-file).
.IP "\[ci]" 4
\fB\-t, \-\-template=[name]\fR: Name of a template file.
.IP "\[ci]" 4
\fB\-c, \-\-compress\fR: Compact JSON output format (zero indent). 
.IP "\[ci]" 4
\fB\-q, \-\-query=[params...]\fR: Query string parameters.
.IP "\[ci]" 4
\fB\-h, \-\-header=[key: value...]\fR: Additional HTTP headers.
.IP "\[ci]" 4
\fB\-s, \-\-server=[url]\fR: Database server.
.IP "\[ci]" 4
\fB\-\-[no]\-interactive\fR: Disable interactive prompts.
.IP "\[ci]" 4
\fB\-\-recursive\fR: Read directories recursively.
.IP "\[ci]" 4
\fB\-\-destination=[url]\fR: Copy destination.
.IP "\[ci]" 4
\fB\-\-force\fR: Force file overwrite.
.IP "\[ci]" 4
\fB\-\-ddoc=[name]\fR: Design document id.
.IP "\[ci]" 4
\fB\-n, \-\-name=[name]\fR: Design document function name (view|update|show|list).
.IP "\[ci]" 4
\fB\-\-feed=[type]\fR: Poll feed type. 
.IP "\[ci]" 4
\fB\-\-http\fR: Enable HTTP logs.
.IP "\[ci]" 4
\fB\-\-trace\fR: Set log level to trace.
.IP "\[ci]" 4
\fB\-\-debug\fR: Set log level to debug.
.IP "\[ci]" 4
\fB\-\-info\fR: Set log level to info.
.IP "\[ci]" 4
\fB\-\-warn\fR: Set log level to warn.
.IP "\[ci]" 4
\fB\-\-error\fR: Set log level to error.
.IP "\[ci]" 4
\fB\-\-help\fR: Display this help and exit.
.IP "\[ci]" 4
\fB\-\-version\fR: Print version and exit.
.EL
.SH "LOG"
.PP
All log output is sent to \fBstderr\fR, response documents are printed to \fBstdout\fR. You may set the program log level using the \fB\-\-trace\fR, \fB\-\-debug\fR, \fB\-\-info\fR, \fB\-\-warn\fR and \fB\-\-error\fR options. The default log level is \fBinfo\fR.
.PP
Enable logging of HTTP requests and responses by also specifiying \fB\-\-http\fR option, any level specified using the aforementioned options applies to the HTTP logger. When the HTTP log level is \fBinfo\fR basic request and response information is logged (HTTP verb, request URL and response status code). When the log level is \fBdebug\fR then query string parameters will also be logged, if the \fBtrace\fR level is specified then request and response headers are also printed.
.SH "HEADERS"
.PP
Similar to \fBcurl(1)\fR arbitrary HTTP headers are accepted using the \fB\-h | \-\-header\fR option (note the short version is lowercase), you may specify as many headers as you like although \fBContent\-Type\fR and \fBAccept\fR are ignored, a warning is printed if you attempt to use them.
.PP
If the value of the \fB\-\-header\fR option is incorrect (bad syntax) an error is reported.
.PP
Use the HTTP logging option to inspect the request headers:

.SP
  rlx doc get \-s {server} \-d {database} \-i {document} \e
.br
    \-h 'if\-none\-match: "{revision}"' \-\-http \-\-trace
.PP
The \fB\-\-rev\fR would be more concise in the above example, however it illustrates the ability to set and inspect headers.
.SH "QUERY STRING"
.PP
The \fBcouchdb\fR database server accepts many different query string parameters for different API calls, as such the query string parameter handling is flexible.
.PP
To specify query string parameters use the \fB\-q | \-\-query\fR option, this option is repeatable so you may specify each parameter as an individual option or combine the entire query string.
.PP
Some options map to query string parameters (for example \fB\-r | \-\-rev\fR) if you specify an option that maps to a query string parameter and the same parameter using \fB\-\-query\fR then the specific option value has precedence.
.PP
You may specify a leading \fB?\fR but it is unnecessary and not recommended.
.PP
To elucidate you can fetch document revision information with the \fBrevsinfo\fR shortcut command:

  rlx doc revsinfo \-s {server} \-d {database} \-i {id}
.PP
But you could also use \fB\-q | \-\-query\fR:

  rlx doc get \-s {server} \-d {database} \-i {id} \-q 'revsinfo=true'
.PP
An example of precedence:

  rlx doc get \-s {server} \-d {database} \-i {id} \-r {rev} \-q 'rev={revision}'
.PP
The value of \fB{rev}\fR will be used \fInot\fR \fB{revision}\fR.
.SH "HIGHLIGHT"
.PP
The program will attempt to syntax highlight JSON and javascript documents using either \fBsource\-highlight\fR or \fBpygmentize\fR. Document highlighting will not occur under the following conditions:
.BL
.IP "\[ci]" 4
Neither \fBsource\-highlight\fR or \fBpygmentize\fR is in \fB$PATH\fR.
.IP "\[ci]" 4
The \fBstdout\fR stream is not a \fBtty\fR (redirection).
.IP "\[ci]" 4
The \fB\-o | \-\-output\fR option is specified (output is a file).
.IP "\[ci]" 4
The \fB\-\-no\-color\fR option is specified (disables all ANSI escape sequences).
.IP "\[ci]" 4
The rc file \fBhighlight\fR section is invalid (does not contain json and js objects).
.IP "\[ci]" 4
The output to print is neither JSON or javascript (\-\-raw specified).
.EL
.SH "ENVIRONMENT"
.PP
The \fB$HOME\fR environment variable must be set in order for user configuration data to be loaded, typically for most developer environments this is not an issue however when using \fBrlx(1)\fR as part of infrastructure deployment you may need to ensure that \fB$HOME\fR is set.
.SH "FILES"
.PP
Input files are read with the following precedence: \fBstdin\fR, \fB\-\-json\fR and \fB\-\-file\fR. 
.PP
To read from \fBstdin\fR the special option (\-) must be specified, if data is written to \fBstdin\fR it must be a JSON document or an error is reported. When the \fB\-\-json\fR option is specified it must be a valid JSON string literal, be sure to enclose in quotes to prevent shell errors.
.PP
If both the \fB\-\-json\fR and \fB\-\-file\fR options are specified the JSON literal is preferred.
.PP
Files specified using the \fB\-\-file\fR option may be a file system path or URL. Relative paths are resolved according to the current working directory. For example:

.SP
  rlx lint \-f package.json
.br
  rlx lint \-f http://registry.npmjs.org
.br
  rlx lint \-j '{}'
.br
  cat package.json | rlx \- lint
.SH "HISTORY"
.PP
This program was originally implemented in bash shell script, see https://github.com/freeformsystems/rlx\-shell.
.PP
Bash was chosen for ease of readline integration and the ability to concisely pipe between programs amongst other features. However implementing a complex program in shell script is non\-trivial and it needed to rely on external languages for JSON support.
.PP
The original implementation whilst almost feature complete was deprecated in favour of a pure javascript version. In addition the original implementation started from a pure interactive REPL perspective with a view to implementing non\-interactive support later \- it never happened.
.PP
For the javascript program an inverse approach is taken, the REPL is the last feature to be implemented.
.SH "BUGS"
.PP
Report bugs to https://github.com/freeformsystems/rlx/issues.
